from ioc_richer.src.http.request import post_request, HEADERS

MALWARE_BAZAAR = "https://mb-api.abuse.ch/api/v1/"


def search_malwarebazaar(data: str):
    """Search in threatfox-api.abuse.ch.

    Args:
        data (str): ip,domain,str


    """
    # curl -X POST https://threatfox-api.abuse.ch/api/v1/ -d '{ "query": "search_ioc", "search_term": "139.180.203.104" }'
    response = post_request.get(
        MALWARE_BAZAAR.format(data),
        "query=get_info&hash={}".format(data),
        HEADERS,
    )
    if response.status_code == 200:
        return response.text
